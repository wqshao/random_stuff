#AoV Day 3
#Post parse 

#Sample data 
x1 <- as.numeric(c(0,	75,	75,	158,	158,	146,	146,	217,	217,	145))
y1 <- as.numeric(c(0,	0,	-30,	-30,	53,	53,	4,	4,	11,	11))

x2 <- as.numeric(c(0,	0,	66,	66,	100,	100,	155,	155,	238,	238))
y2 <- as.numeric(c(0,	62,	62,	117,	117,	46,	46,	-12,	-12,	-12))


#Inputs
x1 <- as.numeric(c(0,	1000,	1000,	1195,	1195,	1999,	1999,	1549,	1549,	2317,	2317,	1769,	1769,	1033,	1033,	881,	881,	211,	211,	-66,	-66,	-356,	-356,	145,	145,	-786,	-786,	-451,	-451,	-476,	-476,	402,	402,	1055,	1055,	1478,	1478,	685,	685,	-54,	-54,	454,	454,	886,	886,	983,	983,	308,	308,	250,	250,	-469,	-469,	-325,	-325,	59,	59,	-25,	-25,	922,	922,	566,	566,	893,	893,	1718,	1718,	1389,	1389,	440,	440,	-531,	-531,	-624,	-624,	-379,	-379,	-57,	-57,	-661,	-661,	-363,	-363,	-528,	-528,	-348,	-348,	608,	608,	1393,	1393,	599,	599,	1574,	1574,	1408,	1408,	1184,	1184,	518,	518,	1314,	1314,	458,	458,	-530,	-530,	-789,	-789,	-302,	-302,	-637,	-637,	-1074,	-1074,	-453,	-453,	425,	425,	679,	679,	-48,	-48,	304,	304,	-23,	-23,	-877,	-877,	-734,	-734,	155,	155,	-190,	-190,	-155,	-155,	-78,	-78,	873,	873,	7,	7,	249,	249,	-313,	-313,	-809,	-809,	-1189,	-1189,	-545,	-545,	-1075,	-1075,	-747,	-747,	-1236,	-1236,	-1162,	-1162,	-796,	-796,	-192,	-192,	-765,	-765,	178,	178,	-604,	-604,	-995,	-995,	-467,	-467,	-312,	-312,	-85,	-85,	473,	473,	697,	697,	1209,	1209,	1301,	1301,	2053,	2053,	1715,	1715,	1202,	1202,	346,	346,	159,	159,	-28,	-28,	-334,	-334,	-47,	-47,	431,	431,	1133,	1133,	828,	828,	74,	74,	834,	834,	117,	117,	-104,	-104,	-438,	-438,	-1399,	-1399,	-1466,	-1466,	-1923,	-1923,	-2428,	-2428,	-1712,	-1712,	-1748,	-1748,	-1694,	-1694,	-964,	-964,	-1029,	-1029,	-880,	-880,	-524,	-524,	-5,	-5,	-449,	-449,	-121,	-121,	-869,	-869,	-1303,	-1303,	-859,	-859,	-701,	-701,	-1331,	-1331,	-422,	-422,	-1379,	-1379,	-2023,	-2023,	-1350,	-1350,	-415,	-415,	185,	185,	-486,	-486,	-1370,	-1370,	-836,	-836,	-561,	-561,	10,	10,	-497,	-497,	498,	498,	484,	484,	-471,	-471,	108,	108,	813,	813,	1282,	1282,	1902,	1902,	2809,	2809,	3633,	3633,	2899,	2899,	2415))
y1 <- as.numeric(c(0,	0,	371,	371,	507,	507,	1312,	1312,	1523,	1523,	2291,	2291,	2645,	2645,	3076,	3076,	3734,	3734,	3472,	3472,	3608,	3608,	4547,	4547,	5097,	5097,	4258,	4258,	3766,	3766,	3846,	3846,	4201,	4201,	4387,	4387,	3902,	3902,	3643,	3643,	4322,	4322,	4053,	4053,	3292,	3292,	2831,	2831,	3789,	3789,	4137,	4137,	3866,	3866,	4715,	4715,	4787,	4787,	5280,	5280,	5310,	5310,	4868,	4868,	5514,	5514,	6232,	6232,	6059,	6059,	5714,	5714,	4884,	4884,	5390,	5390,	5014,	5014,	4909,	4909,	4849,	4849,	3890,	3890,	3467,	3467,	2940,	2940,	1996,	1996,	2637,	2637,	2455,	2455,	1736,	1736,	2710,	2710,	2953,	2953,	3659,	3659,	3059,	3059,	2146,	2146,	1153,	1153,	1504,	1504,	1080,	1080,	1990,	1990,	1810,	1810,	1807,	1807,	1619,	1619,	1226,	1226,	2055,	2055,	3013,	3013,	2855,	2855,	2838,	2838,	2384,	2384,	2119,	2119,	2903,	2903,	2774,	2774,	2891,	2891,	1911,	1911,	2557,	2557,	1954,	1954,	2681,	2681,	3009,	3009,	2505,	2505,	3308,	3308,	2762,	2762,	2389,	2389,	2843,	2843,	1935,	1935,	2029,	2029,	1547,	1547,	1520,	1520,	2017,	2017,	1750,	1750,	1799,	1799,	1741,	1741,	1212,	1212,	214,	214,	-677,	-677,	166,	166,	200,	200,	604,	604,	1550,	1550,	670,	670,	642,	642,	198,	198,	730,	730,	1399,	1399,	1658,	1658,	1216,	1216,	1792,	1792,	2128,	2128,	2829,	2829,	2552,	2552,	1689,	1689,	1885,	1885,	1986,	1986,	1830,	1830,	1020,	1020,	304,	304,	260,	260,	-464,	-464,	-1124,	-1124,	-1462,	-1462,	-1038,	-1038,	-1020,	-1020,	-1153,	-1153,	-779,	-779,	-1768,	-1768,	-1175,	-1175,	-1445,	-1445,	-1278,	-1278,	-2075,	-2075,	-1324,	-1324,	-1395,	-1395,	-1925,	-1925,	-1778,	-1778,	-2772,	-2772,	-2251,	-2251,	-2830,	-2830,	-2639,	-2639,	-2402,	-2402,	-2723,	-2723,	-1762,	-1762,	-1384,	-1384,	-1430,	-1430,	-585,	-585,	-340,	-340,	-67,	-67,	341,	341,	-458,	-458,	-992,	-992,	-1086,	-1086,	-1477,	-1477,	-1858,	-1858,	-1696,	-1696,	-2522,	-2522,	-2355,	-2355,	-1433,	-1433))

x2 <- as.numeric(c(0,	-1007,	-1007,	-154,	-154,	-167,	-167,	-420,	-420,	477,	477,	-385,	-385,	-1035,	-1035,	-948,	-948,	-1844,	-1844,	-2708,	-2708,	-2783,	-2783,	-1882,	-1882,	-2535,	-2535,	-3392,	-3392,	-3535,	-3535,	-4199,	-4199,	-4746,	-4746,	-4110,	-4110,	-4160,	-4160,	-3872,	-3872,	-3908,	-3908,	-4517,	-4517,	-5231,	-5231,	-6170,	-6170,	-6736,	-6736,	-6493,	-6493,	-6046,	-6046,	-5138,	-5138,	-4314,	-4314,	-4280,	-4280,	-4738,	-4738,	-5158,	-5158,	-5783,	-5783,	-6512,	-6512,	-5602,	-5602,	-6586,	-6586,	-7286,	-7286,	-8218,	-8218,	-7593,	-7593,	-7845,	-7845,	-8223,	-8223,	-7924,	-7924,	-8400,	-8400,	-8164,	-8164,	-7574,	-7574,	-7113,	-7113,	-7382,	-7382,	-8058,	-8058,	-7739,	-7739,	-7664,	-7664,	-8142,	-8142,	-8380,	-8380,	-7492,	-7492,	-7676,	-7676,	-7410,	-7410,	-8066,	-8066,	-8818,	-8818,	-9649,	-9649,	-10312,	-10312,	-9895,	-9895,	-10254,	-10254,	-10242,	-10242,	-10574,	-10574,	-10000,	-10000,	-10857,	-10857,	-10547,	-10547,	-11260,	-11260,	-10670,	-10670,	-10541,	-10541,	-9709,	-9709,	-8728,	-8728,	-7864,	-7864,	-7596,	-7596,	-7648,	-7648,	-7203,	-7203,	-6318,	-6318,	-6163,	-6163,	-6112,	-6112,	-5587,	-5587,	-4970,	-4970,	-5526,	-5526,	-5669,	-5669,	-6436,	-6436,	-5615,	-5615,	-5329,	-5329,	-5040,	-5040,	-5025,	-5025,	-4979,	-4979,	-3996,	-3996,	-3037,	-3037,	-2079,	-2079,	-1596,	-1596,	-1614,	-1614,	-1792,	-1792,	-2291,	-2291,	-2835,	-2835,	-2021,	-2021,	-1876,	-1876,	-2796,	-2796,	-3729,	-3729,	-4726,	-4726,	-5303,	-5303,	-6076,	-6076,	-5959,	-5959,	-4961,	-4961,	-4059,	-4059,	-4220,	-4220,	-4873,	-4873,	-4964,	-4964,	-5102,	-5102,	-4955,	-4955,	-4591,	-4591,	-5355,	-5355,	-5473,	-5473,	-4699,	-4699,	-4548,	-4548,	-3811,	-3811,	-3725,	-3725,	-2734,	-2734,	-2174,	-2174,	-1951,	-1951,	-1020,	-1020,	-468,	-468,	-184,	-184,	-1151,	-1151,	-211,	-211,	-74,	-74,	-80,	-80,	-525,	-525,	363,	363,	-489,	-489,	-1266,	-1266,	-1163,	-1163,	-1043,	-1043,	-1685,	-1685,	-772,	-772,	-703,	-703,	161,	161,	-370,	-370,	-1034,	-1034,	-233,	-233,	-1057,	-1057,	-1583,	-1583,	-1383,	-1383,	-1368,	-1368,	-386,	-386,	-424,	-424,	-338,	-338,	-1157,	-1157,	-778,	-778,	-1022))
y2 <- as.numeric(c(0,	0,	-620,	-620,	-543,	-543,	-70,	-70,	-480,	-480,	-16,	-16,	265,	265,	-205,	-205,	-409,	-409,	261,	261,	-689,	-689,	-1009,	-1009,	-1794,	-1794,	-2019,	-2019,	-1403,	-1403,	-463,	-463,	-332,	-332,	-1077,	-1077,	-508,	-508,	-54,	-54,	-308,	-308,	69,	69,	998,	998,	1083,	1083,	2006,	2006,	1726,	1726,	2674,	2674,	2667,	2667,	2516,	2516,	2084,	2084,	2003,	2003,	2748,	2748,	1766,	1766,	2676,	2676,	2402,	2402,	2724,	2724,	2636,	2636,	2287,	2287,	2797,	2797,	2885,	2885,	3670,	3670,	3569,	3569,	3635,	3635,	4331,	4331,	4285,	4285,	4442,	4442,	4747,	4747,	4260,	4260,	4727,	4727,	4203,	4203,	4268,	4268,	5129,	5129,	4413,	4413,	4401,	4401,	3823,	3823,	3597,	3597,	3425,	3425,	3549,	3549,	4359,	4359,	4897,	4897,	4127,	4127,	4128,	4128,	4919,	4919,	5191,	5191,	4249,	4249,	4696,	4696,	5038,	5038,	4780,	4780,	4195,	4195,	4080,	4080,	3113,	3113,	2954,	2954,	3377,	3377,	3896,	3896,	3403,	3403,	2746,	2746,	2912,	2912,	2648,	2648,	2016,	2016,	1141,	1141,	2039,	2039,	1653,	1653,	1931,	1931,	1542,	1542,	2411,	2411,	2321,	2321,	2375,	2375,	1611,	1611,	937,	937,	986,	986,	1765,	1765,	1518,	1518,	1674,	1674,	1686,	1686,	2226,	2226,	2713,	2713,	2377,	2377,	2644,	2644,	2509,	2509,	1607,	1607,	1100,	1100,	1461,	1461,	1886,	1886,	1104,	1104,	1955,	1955,	2458,	2458,	3239,	3239,	3337,	3337,	3970,	3970,	4599,	4599,	4580,	4580,	3824,	3824,	3295,	3295,	4208,	4208,	5064,	5064,	4443,	4443,	4597,	4597,	3637,	3637,	4095,	4095,	3614,	3614,	2756,	2756,	2750,	2750,	2449,	2449,	1652,	1652,	2020,	2020,	1334,	1334,	1744,	1744,	1588,	1588,	2231,	2231,	1232,	1232,	955,	955,	1165,	1165,	1129,	1129,	477,	477,	410,	410,	-117,	-117,	-975,	-975,	-1408,	-1408,	-1333,	-1333,	-877,	-877,	-1329,	-1329,	-478,	-478,	-756,	-756,	-623,	-623,	145,	145,	538,	538,	825,	825,	711,	711,	1010,	1010,	119,	119,	-482,	-482))


x1[1]


check_in_string <- function(x, y, start_x, end_x, start_y, end_y){
  in_set <- "No"
  larger_x = max(start_x, end_x)
  smaller_x = min(start_x, end_x)
  larger_y = max(start_y, end_y)
  smaller_y = min(start_y, end_y)

  if (x >= smaller_x && x <= larger_x && y >= smaller_y && y<= larger_y) 
    in_set <- "Yes"
  return(in_set)
}


intersected_x = c()
intersected_y = c()
steps = c()
intersected = data.frame(intersected_x, intersected_y, steps)
line1 <- intersected
line2 <- intersected 

for(i in c(-500:500)){
  for(j in c(-500:500)){
    add_line1 = 0
    add_line2 = 0
    steps1 = 0
    steps2 = 0 

    for(loopi in c(1:length(x1)-1)){
      if(check_in_string(i,j,x1[loopi],x1[loopi+1],y1[loopi],y1[loopi+1]) == "Yes")
        {
        steps1 = sum(abs(x1[2:loopi] - x1[1:loopi-1])) + sum(abs(y1[2:loopi] - y1[1:loopi-1])) + abs(i-x1[loopi]) + abs(j-y1[loopi])
        add_line1 = 1 
        }}
    for(loopi in c(1:length(x2)-1)){
      if(check_in_string(i,j,x2[loopi],x2[loopi+1],y2[loopi],y2[loopi+1]) == "Yes")
        {
        steps2 = sum(abs(x2[2:loopi] - x2[1:loopi-1])) + sum(abs(y2[2:loopi] - y2[1:loopi-1])) + abs(i-x2[loopi]) + abs(j-y2[loopi])
        add_line2 = 1 
    }}
    if(add_line1 == 1)
      line1 = rbind(line1, c(i,j,steps1))
    if(add_line2 == 1)
      line2 = rbind(line2, c(i,j,steps2))
  }
}
   
names(line1) <- c("x","y", "steps1")
names(line2) <- c("x", "y", "steps2")

crossings <- merge(line1,line2)

distance <-abs(crossings$x) + abs(crossings$y)
min(distance)

steps <- crossings$steps1 + crossings$steps2
min(steps)

